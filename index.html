<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SUNBLANKï½œmemories</title>
<link rel="stylesheet" href="css/common.css">
<link rel="stylesheet" href="css/boards.css">
</head>
<body>

<header>
  <h1>SUNBLANKï½œmemories</h1>
</header>
<nav>
  <ul>
    <li><a href="memory_gallery/index.html">ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼</a></li>
    <li><a href="#memories-list">ã‚³ãƒ¡ãƒ³ãƒˆ</a></li>
    <li><a href="#requests-list">ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</a></li>
  </ul>
</nav>

<main class="container">

  <!-- â–¼ æ—…ã®è¨ˆç”» -->
  <h2 class="section-title">æ—…ã®è¨ˆç”»</h2>
  <section class="events">
    <a href="kusatsu2026/index.html" class="event">
      <img src="kusatsu2026/thumb.jpg" alt="è‰æ´¥æ¸©æ³‰">
      <span>è‰æ´¥æ¸©æ³‰æ—…è¡Œï¼ˆæ¡ˆï¼‰</span>
    </a>
    <a href="arima2026/index.html" class="event">
      <img src="arima2026/thumb.jpg" alt="æœ‰é¦¬æ¸©æ³‰">
      <span>æœ‰é¦¬æ¸©æ³‰æ—…è¡Œï¼ˆæ¡ˆï¼‰</span>
    </a>
    <a href="katsunuma2026/index.html" class="event">
      <img src="katsunuma2026/thumb.jpg" alt="ã¶ã©ã†ã®ä¸˜">
      <span>å±±æ¢¨çœŒå‹æ²¼å¸‚ã¶ã©ã†ã®ä¸˜æ—…ï¼ˆæ¡ˆï¼‰</span>
    </a>
  </section>

  <!-- â–¼ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <h2 class="section-title">ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h2>
  <section class="grid-2-1-2">
    <!-- å·¦ï¼šãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚«ãƒ¼ãƒ‰ -->
    <a href="memory_gallery/index.html" class="card-large album">
      <img src="images/gallery-banner.jpg" alt="ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼" class="board-banner">
      <p>ğŸ“¸ æ–°ã—ãè¿½åŠ ï¼ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼ã¯ã“ã¡ã‚‰</p>
    </a>

    <!-- å³ï¼šæ²ç¤ºæ¿2ã¤ -->
    <div class="board-container">
      <!-- æ€ã„å‡ºã‚³ãƒ¡ãƒ³ãƒˆæ²ç¤ºæ¿ -->
      <div class="card-large memories">
        <img src="images/memories-banner.jpg" alt="æ€ã„å‡ºã‚³ãƒ¡ãƒ³ãƒˆ" class="board-banner">
        <p class="board-title">æ€ã„å‡ºã‚³ãƒ¡ãƒ³ãƒˆæ²ç¤ºæ¿</p>
        <form id="memoriesForm">
          <input type="text" id="memoriesName" placeholder="åå‰" required>
          <textarea id="memoriesText" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆå†…å®¹" required></textarea>
          <button type="submit">æŠ•ç¨¿</button>
        </form>
        <section class="memories-board" id="memories-list"></section>
      </div>

      <!-- ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ²ç¤ºæ¿ -->
      <div class="card-large request">
        <img src="images/request-banner.jpg" alt="ãƒªã‚¯ã‚¨ã‚¹ãƒˆ" class="board-banner">
        <p class="board-title">ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ²ç¤ºæ¿</p>
        <form id="requestForm">
          <input type="text" id="requestName" placeholder="åå‰" required>
          <textarea id="requestText" placeholder="ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹" required></textarea>
          <button type="submit">æŠ•ç¨¿</button>
        </form>
        <section class="request-board" id="requests-list"></section>
      </div>
    </div>
  </section>

</main>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, updateDoc, doc, serverTimestamp } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAMynBwvGhlGbEi6UCHrZjYHNedf9pqXJQ",
    authDomain: "sunblank-memories.firebaseapp.com",
    projectId: "sunblank-memories",
    storageBucket: "sunblank-memories.appspot.com",
    messagingSenderId: "916551819188",
    appId: "1:916551819188:web:741bfd8c4534b511e35ce1"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // â–¼ æ€ã„å‡ºã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿å‡¦ç†
  const memoriesForm = document.getElementById("memoriesForm");
  memoriesForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = document.getElementById("memoriesName").value;
    const text = document.getElementById("memoriesText").value;
    await addDoc(collection(db, "memories"), {
      name,
      text,
      createdAt: serverTimestamp()
    });
    memoriesForm.reset();
  });

  // â–¼ æ€ã„å‡ºã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§è¡¨ç¤º
  const memoriesList = document.getElementById("memories-list");
  const qMemories = query(collection(db, "memories"), orderBy("createdAt", "desc"));
  onSnapshot(qMemories, (snapshot) => {
    memoriesList.innerHTML = "";
    snapshot.forEach((docSnap) => {
      const data = docSnap.data();
      const card = document.createElement("div");
      card.className = "card";
      let dateText = "";
      if (data.createdAt) {
        dateText = data.createdAt.toDate().toLocaleString("ja-JP");
      }
      card.innerHTML = `
        <p><strong>${data.name}</strong>ï¼š${data.text}</p>
        ${dateText ? `<small>æŠ•ç¨¿æ—¥æ™‚: ${dateText}</small>` : ""}
      `;
      memoriesList.appendChild(card);
    });
  });

  // â–¼ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæŠ•ç¨¿å‡¦ç†
  const requestForm = document.getElementById("requestForm");
  <!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SUNBLANKï½œmemories</title>
<link rel="stylesheet" href="css/common.css">
</head>
<body>

<header>
  <h1>SUNBLANKï½œmemories</h1>
</header>
<nav>
  <ul>
    <li><a href="memory_gallery/index.html">ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼</a></li>
    <li><a href="#memories-list">ã‚³ãƒ¡ãƒ³ãƒˆ</a></li>
    <li><a href="#requests-list">ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</a></li>
    <li><a href="#galleryRequestsList">ã‚®ãƒ£ãƒ©ãƒªãƒ¼è¿½åŠ </a></li>
  </ul>
</nav>

<main class="container">

  <!-- â–¼ æ—…ã®è¨ˆç”» -->
  <h2 class="section-title">æ—…ã®è¨ˆç”»</h2>
  <section class="events">
    <a href="kusatsu2026/index.html" class="event">
      <img src="kusatsu2026/thumb.jpg" alt="è‰æ´¥æ¸©æ³‰">
      <span>è‰æ´¥æ¸©æ³‰æ—…è¡Œï¼ˆæ¡ˆï¼‰</span>
    </a>
    <a href="arima2026/index.html" class="event">
      <img src="arima2026/thumb.jpg" alt="æœ‰é¦¬æ¸©æ³‰">
      <span>æœ‰é¦¬æ¸©æ³‰æ—…è¡Œï¼ˆæ¡ˆï¼‰</span>
    </a>
    <a href="katsunuma2026/index.html" class="event">
      <img src="katsunuma2026/thumb.jpg" alt="ã¶ã©ã†ã®ä¸˜">
      <span>å±±æ¢¨çœŒå‹æ²¼å¸‚ã¶ã©ã†ã®ä¸˜æ—…ï¼ˆæ¡ˆï¼‰</span>
    </a>
  </section>

  <!-- â–¼ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <h2 class="section-title">ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h2>
  <section class="grid-2-1-2">
    <!-- å·¦ï¼šãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚«ãƒ¼ãƒ‰ -->
    <a href="memory_gallery/index.html" class="card-large album">
      <img src="images/gallery-banner.jpg" alt="ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼" class="board-banner">
      <p>ğŸ“¸ æ–°ã—ãè¿½åŠ ï¼ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼ã¯ã“ã¡ã‚‰</p>
    </a>

    <!-- å³ï¼šæ²ç¤ºæ¿3ã¤ -->
    <div class="board-container">
      <!-- æ€ã„å‡ºã‚³ãƒ¡ãƒ³ãƒˆæ²ç¤ºæ¿ -->
      <div class="card-large memories">
        <img src="images/memories-banner.jpg" alt="æ€ã„å‡ºã‚³ãƒ¡ãƒ³ãƒˆ" class="board-banner">
        <p class="board-title">æ€ã„å‡ºã‚³ãƒ¡ãƒ³ãƒˆæ²ç¤ºæ¿</p>
        <form id="memoriesForm">
          <input type="text" id="memoriesName" placeholder="åå‰" required>
          <textarea id="memoriesText" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆå†…å®¹" required></textarea>
          <button type="submit">æŠ•ç¨¿</button>
        </form>
        <section class="memories-board" id="memories-list"></section>
      </div>

      <!-- ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ²ç¤ºæ¿ -->
      <div class="card-large request">
        <img src="images/request-banner.jpg" alt="ãƒªã‚¯ã‚¨ã‚¹ãƒˆ" class="board-banner">
        <p class="board-title">ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ²ç¤ºæ¿</p>
        <form id="requestForm">
          <input type="text" id="requestName" placeholder="åå‰" required>
          <textarea id="requestText" placeholder="ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹" required></textarea>
          <button type="submit">æŠ•ç¨¿</button>
        </form>
        <section class="request-board" id="requests-list"></section>
      </div>

      <!-- ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼è¿½åŠ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ²ç¤ºæ¿ -->
      <div class="card-large gallery-request">
        <img src="images/gallery-banner.jpg" alt="ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼è¿½åŠ " class="board-banner">
        <p class="board-title">ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼è¿½åŠ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</p>
        <form id="galleryRequestForm">
          <input type="text" id="galleryRequestName" placeholder="åå‰" required>
          <textarea id="galleryRequestText" placeholder="è¿½åŠ ã—ã¦ã»ã—ã„å†™çœŸã®å†…å®¹" required></textarea>
          <button type="submit">æŠ•ç¨¿</button>
        </form>
        <section id="galleryRequestsList"></section>
      </div>
    </div>
  </section>

</main>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, updateDoc, doc, serverTimestamp } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAMynBwvGhlGbEi6UCHrZjYHNedf9pqXJQ",
    authDomain: "sunblank-memories.firebaseapp.com",
    projectId: "sunblank-memories",
    storageBucket: "sunblank-memories.appspot.com",
    messagingSenderId: "916551819188",
    appId: "1:916551819188:web:741bfd8c4534b511e35ce1"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // â–¼ æ€ã„å‡ºã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿å‡¦ç†
  const memoriesForm = document.getElementById("memoriesForm");
  memoriesForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = document.getElementById("memoriesName").value;
    const text = document.getElementById("memoriesText").value;
    await addDoc(collection(db, "memories"), { name, text, createdAt: serverTimestamp() });
    memoriesForm.reset();
  });

  // â–¼ æ€ã„å‡ºã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§è¡¨ç¤º
  const memoriesList = document.getElementById("memories-list");
  const qMemories = query(collection(db, "memories"), orderBy("createdAt", "desc"));
  onSnapshot(qMemories, (snapshot) => {
    memoriesList.innerHTML = "";
    snapshot.forEach((docSnap) => {
      const data = docSnap.data();
      const card = document.createElement("div");
      card.className = "card";
      let dateText = data.createdAt ? data.createdAt.toDate().toLocaleString("ja-JP") : "";
      card.innerHTML = `<p><strong>${data.name}</strong>ï¼š${data.text}</p>${dateText ? `<small>æŠ•ç¨¿æ—¥æ™‚: ${dateText}</small>` : ""}`;
      memoriesList.appendChild(card);
    });
  });

  // â–¼ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæŠ•ç¨¿å‡¦ç†
  const requestForm = document.getElementById("requestForm");
  requestForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = document.getElementById("requestName").value;
    const text = document.getElementById("requestText").value;
    await addDoc(collection(db, "requests"), { name, text, createdAt: serverTimestamp(), status: "è€ƒãˆä¸­â€¦" });
    requestForm.reset();
  });

  // â–¼ ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¸€è¦§è¡¨ç¤º
  const requestsList = document.getElementById("requests-list");
  const qRequests = query(collection(db, "requests"), orderBy("createdAt", "desc"));
  onSnapshot(qRequests, (snapshot) => {
    requestsList.innerHTML = "";
    snapshot.forEach((docSnap) => {
      const data = docSnap.data();
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <p><strong>${data.name}</strong>ï¼š${data.text}</p>
        <p>çŠ¶æ…‹ï¼š${data.status || "è€ƒãˆä¸­â€¦"}</p>
        <div class="status-buttons">
          <button onclick="updateStatus('${docSnap.id}','å¶ã£ãŸï¼')">å¶ã£ãŸï¼</button>
          <button onclick="updateStatus('${docSnap.id}','æº–å‚™ä¸­ï¼')">æº–å‚™ä¸­ï¼</button>
          <button onclick="updateStatus('${docSnap.id}','è€ƒãˆä¸­â€¦')">è€ƒãˆä¸­â€¦</button>
          <button onclick="updateStatus('${docSnap.id}','ã¾ãŸä»Šåº¦ï¼')">ã¾ãŸä»Šåº¦ï¼</button>
        </div>
      `;
      requestsList.appendChild(card);
    });
  });

  // â–¼ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°é–¢æ•°
  window.updateStatus = async (id, status) => {
    const ref = doc(db, "requests", id);
    await updateDoc(ref, { status });
  };

  // â–¼ ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼è¿½åŠ ãƒªã‚¯ã‚¨ã‚¹ãƒˆæŠ•ç¨¿å‡¦ç†
  const galleryRequestForm = document.getElementById("galleryRequestForm");
  galleryRequestForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = document.getElementById("galleryRequestName").value;
    const text = document.getElementById("galleryRequestText").value;
    await addDoc(collection